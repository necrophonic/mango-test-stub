=pod

=head1 TITLE

Test::Mock::Mango - User Guide

=head1 FAKE DATABASE

To support returned I<something vaguely sensible> and, more importantly, I<known data>
from calls, C<Test::Mock::Mango> contains a I<fake database>.

This is implemented in the C<Test::Mock::Mango::FakeData> package as a simple
structure. By default it creates a populated collection of a popular animated family.

To override, simply call it's static properties:

  $Test::Mock::Mango::FakeData->{collection_name} = 'some_new_collection';
  $Test::Mock::Mango::FakeData->{collection} = [ { item => 1 }, { item => 2 } ];

The new state will now be used for subsequent method calls.



=head1 MOCKED METHODS

=head2 Collection

=head3 find

Returns a new C<Test::Mock::Mango::Cursor> on the fake database collection.


=head3 find_one

Returns the first item from the collection in the fake database. Doesn't attempt
to perform any real query.


=head3 full_name

Returns the name of the current fake collection, as given by
C<$Test::Mock::Mango::FakeData->{collection_name}>.


=head3 insert

Simulates an insert. Will push the given document(s) onto the end of the current
fake collection and return a new oid (random - unless inserted document has an
C<_id> property in which case that is returned for the document).

Does not perform any validation or duplicate checks etc.


=head2 Cursor

=head3 all

Return all the documents in the current fake collection.


=head3 next

Naive iterate through the current fake collection. To reset the index, call:

  $cursor->{index} = 0;


=head3 count

Return the number of documents currently in the fake collection.

=end
